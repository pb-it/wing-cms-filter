var jPath=function(){"use strict";function e(e,r){return r.startsWith("!")?!e.includes(parseInt(r.substring(1))):e.includes(parseInt(r))}const r=function(r,n){var t;if(n.indexOf(",")>=0){t=n.split(",").some((n=>e(r,n)))}else{var i,s=n.indexOf("("),a=n.lastIndexOf(")"),f=s>=0&&a>0;i=f?n.substring(s+1,a):n,t=function(r,n){var t;if(n.indexOf("&&")>=0){t=n.split("&&").every((n=>e(r,n)))}else if(n.indexOf("||")>=0){t=n.split("||").some((n=>e(r,n)))}else t=e(r,n);return t}(r,i),f&&n.startsWith("!")&&(t=!t)}return t};function n(e,r){for(var s,a,f=0,l=!1,c=!1,o=!1,u=!1,h=!1,g=-1,v=-1,b=0;b<r.length;b++){switch(r[b]){case"(":f++,-1==g&&(c=!0,g=b,b>0&&"!"==r[b-1]&&(l=!0));break;case")":if(!(f>0))throw new Error("invalid expression");f--;break;case".":-1==g&&b>0&&"@"==r[b-1]&&(o=!0,g=b-1,b>1&&"!"==r[b-2]&&(l=!0));break;case"&":if(0==f&&b>0&&"&"==r[b-1]){if(!(g>=0))throw new Error("invalid expression");u=!0,v=b-1}break;case"|":if(0==f&&b>0&&"|"==r[b-1]){if(!(g>=0))throw new Error("invalid expression");h=!0,v=b-1}}if(v>=0)break}if(0!=f)throw new Error("invalid expression");if(g>=0?(-1==v&&(v=r.length),o?a=r.substring(g,v):c&&(a=r.substring(g+1,v-1))):a=r,o)s=function(e,r){var n=[];if(!r.startsWith("@."))throw"invalid predicate";var s,a,f,l;if((r=r.substring(2)).indexOf("==")>=0)s="==";else if(r.indexOf("!=")>=0)s="!=";else if(r.indexOf("=~")>=0)s="=~";else if(r.indexOf(">=")>=0)s=">=";else if(r.indexOf("<=")>=0)s="<=";else{if(r.indexOf("=")>=0)throw new Error("invalid operator");r.indexOf(">")>=0?s=">":r.indexOf("<")>=0&&(s="<")}null==s?a=i(r):null!=(l=r.split(s))&&2==l.length&&(a=i(l[0]),f=l[1]);if(null!=a)for(var c,o=0;o<e.length;o++)t(c=e[o],a,s,f)&&n.push(c);return n}(e,a);else{if(!c)throw new Error("invalid expression");s=n(e,a)}return l&&(s=e.filter((e=>!s.includes(e)))),u?s=n(s,r.substring(v+2)):h&&(s=[...new Set([...s,...n(e,r.substring(v+2))])]),s}function t(e,n,i,s){var f=!1;if(e){var l=n[0],c=e[l.name];if(c)if(1==n.length)l.type==a.object&&(f=function(e,r,n){var t=!1;if(null!=r)if(null!=e){var i=n.split('"');switch(3!=i.length||i[0]||i[2]||(n=i[1]),r){case"==":case"!=":var s,a=new RegExp(',(?=(?:[^"]*"[^"]*")*[^"]*$)'),f=n.split(a);for(var l in f)(s=f[l]).startsWith('"')&&s.endsWith('"')&&(f[l]=s.substring(1,s.length-1));var c=f.includes(e.toString());t="=="==r?c:!c;break;case"=~":var o;(a=n).indexOf("/")>=0&&3==(i=a.split("/")).length&&""==i[0]&&(a=i[1],o=i[2]),t=new RegExp(a,o).test(e);break;case">=":t=e>=n;break;case"<=":t=e<=n;break;case">":t=e>n;break;case"<":t=e<n}}else"!="==r&&(t=!0);else t=null!=e;return t}(c,i,s));else{var o=n.slice(1);if(l.type==a.object)f=t(c,o,i,s);else if(l.type==a.array)if(2==n.length){var u=n[1].name;if("length()"==u){var h=c.length;switch(i){case"==":f=h==s;break;case"!=":f=h!=s;break;case"~=":break;case">=":f=h>=s;break;case"<=":f=h<=s;break;case">":f=h>s;break;case"<":f=h<s}}else if("=="==i||"!="==i){var g=r(Array.from(c,(e=>e[u])),s);"=="==i?f=g:"!="==i&&(f=!g)}}else for(var v=c,b=0;b<v.length&&!(f=t(v[b],o,i,s));b++);}else"!="==i&&(f=!0)}else"!="==i&&(f=!0);return f}function i(e){for(var r=[],n=e.split("."),t=0;t<n.length;t++)r.push(s(n[t]));return r}function s(e){return e.endsWith("[*]")?new f(e.substring(0,e.length-3),a.array):new f(e,a.object)}const a=Object.freeze({number:1,string:2,object:3,array:4});class f{constructor(e,r){this.name=e,this.type=r}}return function(e,r){return function(e,r){(r=function(e){var r=e.split('"');if(r.length%2==1)for(var n=0;n<r.length;n+=2)r[n]=r[n].replace(/\s/g,"");return r.join('"')}(r)).startsWith("$.");(r=function(e){var r,n=e.indexOf("["),t=e.lastIndexOf("]");if(!(n>=0&&t>0))throw new Error("incorrect clasping");r=e.substring(n+1,t);return r}(r)).startsWith("?");return r=function(e){var r,n=e.indexOf("("),t=e.lastIndexOf(")");if(!(n>=0&&t>0))throw new Error("incorrect clasping");r=e.substring(n+1,t);return r}(r),n(e,r)}(e,r)}}();
